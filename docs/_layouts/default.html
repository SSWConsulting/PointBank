<!doctype html>
<html lang="{{ site.lang | default: "en-US" }}">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

{% seo %}
    <link rel="stylesheet" href="{{ '/assets/css/style.css?v=' | append: site.github.build_revision | relative_url }}">
    <script src="{{ '/assets/js/scale.fix.js' | relative_url }}"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1 class="header">{{ site.title | default: site.github.repository_name }}</h1>
        <p class="header">{{ site.description | default: site.github.project_tagline }}</p>

        <p class="header">This project is maintained by <a class="header name" href="{{ site.github.owner_url }}">{{ site.github.owner_name }}</a></p>
      </header>

      <section>
        {{ content }}
      </section>

      <footer>
        <ul>
          <li><a href="/">PowerPoint Specs</a></li>
          <li><a href="/ui_mockups">UI Mockups</a></li>
        </ul>
        Issues
        <div id="issues-container">
          <!-- TODO: put issues in a table -->
          <ul id="issues"></ul>
          <a href="{{ site.github.issues_url }}/new">Create Issue</a>
        </div>
        <p><small>Hosted on <a href="https://pages.github.com">GitHub Pages</a> using the Dinky theme</small></p>
      </footer>
    </div>

    <style>
      #issues-container {
        max-height: 30vh;
      }
    </style>

    <script>

        function loadJSONP(path, callbackName) {
            var head = document.getElementsByTagName('head')[0];
            var el = document.createElement('script');
            el.src = path + '&callback=' + callbackName;
            head.insertBefore(el, head.firstChild);
        }

        function APICallback(results) {
            var content = document.getElementById("issues");
            var ul = document.createElement("ul");
            for (var i = 0; i < results.data.length; i++) {
                var issue = results.data[i];
                var li = document.createElement("li");
                var a = document.createElement("a");
                a.href = issue.html_url;
                a.textContent = issue.title;
                a.setAttribute("target", "_blank");
                li.appendChild(a);
                ul.appendChild(li);
            }
            content.appendChild(ul);
        }
        
        loadJSONP(`https://api.github.com/repos/{{ site.github.owner_name }}/{{ site.github.repository_name }}/issues?state=open`, "APICallback");
        
    </script>

    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
    {% if site.google_analytics %}
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', '{{ site.google_analytics }}', 'auto');
        ga('send', 'pageview');
      </script>
    {% endif %}
  </body>
</html>
